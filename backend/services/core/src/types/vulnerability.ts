export interface Vulnerability {
  id: string;
  title: string;
  description: string;
  severity: 'Critical' | 'High' | 'Medium' | 'Low';
  status: 'open' | 'in_progress' | 'resolved' | 'false_positive' | 'wont_fix';
  priority: 'P1' | 'P2' | 'P3' | 'P4';
  
  // CVE/CWE Information
  cve?: string;
  cwe?: string;
  cvss_score?: number;
  
  // Component Information
  component: string;
  version?: string;
  
  // Impact and Risk
  impact: string;
  exploitability: 'Functional' | 'Proof of Concept' | 'Unproven' | 'Not Defined';
  remediationComplexity: 'Low' | 'Medium' | 'High';
  businessImpact: 'Critical' | 'High' | 'Medium' | 'Low';
  
  // Remediation
  remediation: string;
  references: string[];
  
  // Assignment and Tracking
  assignedTo?: string;
  discoveredAt: Date;
  lastSeen: Date;
  resolvedAt?: Date;
  
  // Project Association
  projectId: string;
  threatModelId?: string;
  affectedAssets: string[];
  
  // Classification
  tags: string[];
  notes: string;
  
  // Metadata
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
  organizationId: string;
}

export interface CreateVulnerabilityRequest {
  title: string;
  description: string;
  severity: 'Critical' | 'High' | 'Medium' | 'Low';
  component: string;
  version?: string;
  impact: string;
  remediation: string;
  projectId: string;
  threatModelId?: string;
  cve?: string;
  cwe?: string;
  cvss_score?: number;
  exploitability?: 'Functional' | 'Proof of Concept' | 'Unproven' | 'Not Defined';
  remediationComplexity?: 'Low' | 'Medium' | 'High';
  businessImpact?: 'Critical' | 'High' | 'Medium' | 'Low';
  references?: string[];
  assignedTo?: string;
  affectedAssets?: string[];
  tags?: string[];
  notes?: string;
}

export interface UpdateVulnerabilityRequest {
  title?: string;
  description?: string;
  severity?: 'Critical' | 'High' | 'Medium' | 'Low';
  status?: 'open' | 'in_progress' | 'resolved' | 'false_positive' | 'wont_fix';
  priority?: 'P1' | 'P2' | 'P3' | 'P4';
  component?: string;
  version?: string;
  impact?: string;
  remediation?: string;
  cve?: string;
  cwe?: string;
  cvss_score?: number;
  exploitability?: 'Functional' | 'Proof of Concept' | 'Unproven' | 'Not Defined';
  remediationComplexity?: 'Low' | 'Medium' | 'High';
  businessImpact?: 'Critical' | 'High' | 'Medium' | 'Low';
  references?: string[];
  assignedTo?: string;
  affectedAssets?: string[];
  tags?: string[];
  notes?: string;
}

export interface VulnerabilityFilters {
  severity?: string;
  status?: string;
  projectId?: string;
  assignedTo?: string;
  search?: string;
  limit?: number;
  offset?: number;
}

export interface VulnerabilityStatistics {
  total: number;
  bySeverity: {
    critical: number;
    high: number;
    medium: number;
    low: number;
  };
  byStatus: {
    open: number;
    inProgress: number;
    resolved: number;
    falsePositive: number;
    wontFix: number;
  };
  trends: {
    newThisWeek: number;
    resolvedThisWeek: number;
    avgResolutionTime: number;
  };
}